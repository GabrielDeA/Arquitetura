INCLUDE "emu8086.inc"

TAMANHO EQU 32

org 100h

DEFINE_GET_STRING
DEFINE_PRINT_STRING

    MOV DI, OFFSET PALAVRA
    MOV DX, TAMANHO + 1
    CALL GET_STRING
   
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_A
                                 
                                 
    CALL PULA_LINHA                                  
    CALL PROCURA_ESQUERDA_DIREITA
  
   
    CALL PULA_LINHA 
    
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_A
    CALL PROCURANDO_DIREITA_ESQUERDA
    
    CALL PULA_LINHA
    
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_A
    CALL PROCURA_CIMA_BAIXO_ED  
    
    RET_CIMA_BAIXO:
                                      
    CALL PULA_LINHA
    
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_A
    CALL PROCURA_BAIXO_CIMA
                         
    RET_BAIXO_CIMA: 
                         
    CALL PULA_LINHA 
    
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_A
    CALL PROCURA_SUP_ESQUERDA 
    
    RET_SUP_ESQUERDA:   
   
    CALL PULA_LINHA 
    
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_A
    CALL PROCURA_SUP_DIREITA 
    
    RET_SUP_DIREITA:
    
    CALL PULA_LINHA 
    
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_B
    CALL PROCURA_INF_ESQUERDA 
    
    RET_INF_ESQUERDA:
    
    CALL PULA_LINHA 
    
    MOV SI, OFFSET PALAVRA
    MOV DI, OFFSET INICIO_B
    CALL PROCURA_INF_DIREITA
    
    RET_INF_DIREITA:

    MOV AH,4CH
    MOV AL, 0
    INT 21H
   


PROCURA_ESQUERDA_DIREITA:
    PUSHF  
    PUSH DX  
    
    
PROCURANDO_ESQUERDA_DIREITA_IGUAIS:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH, 0
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_ESQUERDA_DIREITA_IGUAIS
    MOV SI, OFFSET PALAVRA
    INC DI
    JMP PROCURANDO_ESQUERDA_DIREITA_IGUAIS
    
IGUAL_PARCIAL_PROCURANDO_ESQUERDA_DIREITA_IGUAIS:
    INC SI
    INC DI
    JMP PROCURANDO_ESQUERDA_DIREITA_IGUAIS
    
ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURA_ESQUERDA_DIREITA
     
    
NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA:
    MOV AH,2
    MOV DL,"N"
    INT 21H
    
FIM_PROCURA_ESQUERDA_DIREITA:
    POP DX
    POPF
    RET 
    
    
  ;POCURA DA DIREITA PARA ESQUERDA
  
    
PROCURANDO_DIREITA_ESQUERDA:
    PUSHF
    PUSH DX 
     
PROCURANDO_DIREITA_ESQUERDA_IR_FINAL:
     MOV DH, [DI]
     CMP DH, 0
     JE  DEC_DI_DIREITA_ESQUERDA
     INC DI
     JMP PROCURANDO_DIREITA_ESQUERDA_IR_FINAL

DEC_DI_DIREITA_ESQUERDA: 
    DEC DI
    
    JMP PROCURANDO_DIREITA_ESQUERDA_IGUAIS
     
PROCURANDO_DIREITA_ESQUERDA_IGUAIS:
    MOV DL, [SI]
    MOV DH, [DI]  
     
    CMP DL, 0
    JE FIM_ACHOU
    CMP DH, 0
   JE FIM_NAO_ACHOU
    CMP DH, DL
    JE ACHOU_PARCIAL_DIREITA_ESQUERDA
    MOV SI, OFFSET PALAVRA
    DEC DI
    JMP PROCURANDO_DIREITA_ESQUERDA_IGUAIS 
    
ACHOU_PARCIAL_DIREITA_ESQUERDA:
    INC SI
    DEC DI
    JMP PROCURANDO_DIREITA_ESQUERDA_IGUAIS    
    
FIM_ACHOU:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURA_DIREITA_ESQUERDA
        
FIM_NAO_ACHOU:
    MOV AH,2
    MOV DL,"N"
    INT 21H
    JMP FIM_PROCURA_DIREITA_ESQUERDA
FIM_PROCURA_DIREITA_ESQUERDA:
    POP DX
    POPF
    RET

    
 
;PROCURA DE CIMA A BAIXO ESQUERDA DIREITA 
 
 

PROCURA_CIMA_BAIXO_ED:
    PUSHF  
    PUSH DX
    PUSH DI  
    
PROCURANDO_CIMA_BAIXO_ED:
    MOV DL, [SI]
    MOV DH, [DI]
    
    CMP DL, 0
    JE  ACHOU_SUBSTRING_CIMA_BAIXO_ED   
    
    CMP DH, '*'
    JE  PROXIMA_COLUNA_CIMA_BAIXO
    
    CMP DH, '#'
    JE  NAO_ACHOU_SUBSTRING_CIMA_BAIXO_ED
    
    CMP DH,DL
    JE  IGUAL_PARCIAL_CIMA_BAIXO_ED 
    
    MOV SI, OFFSET PALAVRA
    ADD DI, 42
    JMP PROCURANDO_CIMA_BAIXO_ED  
    
PROXIMA_COLUNA_CIMA_BAIXO:
    POP DI
    INC DI
    PUSH DI
    JMP PROCURANDO_CIMA_BAIXO_ED
    
IGUAL_PARCIAL_CIMA_BAIXO_ED:
    INC SI
    ADD DI, 42
    JMP PROCURANDO_CIMA_BAIXO_ED
    
ACHOU_SUBSTRING_CIMA_BAIXO_ED:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURA_CIMA_BAIXO
    
    
NAO_ACHOU_SUBSTRING_CIMA_BAIXO_ED:
    MOV AH,2
    MOV DL,"N"
    INT 21H 
    JMP FIM_PROCURA_CIMA_BAIXO
    
FIM_PROCURA_CIMA_BAIXO:
    POP DX
    POPF 
   JMP RET_CIMA_BAIXO    
         
    ; PROCURANDO BAIXO CIMA     
         
PROCURA_BAIXO_CIMA:
    PUSHF
    PUSH DX
    

PROCURANDO_BAIXO_CIMA_IR_FINAL:
    MOV DH, [DI]
    CMP DH, '#' 
    JE CHEGOU_FINAL
    INC DI
    JMP PROCURANDO_BAIXO_CIMA_IR_FINAL 

CHEGOU_FINAL:
    DEC DI
    PUSH DI
    JMP PROCURANDO_BAIXO_CIMA
    
PROCURANDO_BAIXO_CIMA:
    MOV DL, [SI]
    MOV DH, [DI]
    
    CMP DL, 0
    JE ACHOU_BAIXO_CIMA
    
    CMP DH, '$'
    JE PROXIMA_COLUNA_BAIXO_CIMA 
    
    CMP DH, '#'
    JE  NAO_ACHOU_BAIXO_CIMA
    
    CMP DH,DL
    JE  IGUAL_PARCIAL_BAIXO_CIMA 
    
    MOV SI, OFFSET PALAVRA
    SUB DI, 42
    JMP PROCURANDO_BAIXO_CIMA 
    
PROXIMA_COLUNA_BAIXO_CIMA:
    POP DI
    DEC DI
    PUSH DI
    JMP PROCURANDO_BAIXO_CIMA

IGUAL_PARCIAL_BAIXO_CIMA:
    INC SI
    SUB DI,42
    JMP PROCURANDO_BAIXO_CIMA
        
ACHOU_BAIXO_CIMA:    
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_BAIXO_CIMA

NAO_ACHOU_BAIXO_CIMA:
    MOV AH,2
    MOV DL,"N"
    INT 21H
    JMP FIM_BAIXO_CIMA
    
FIM_BAIXO_CIMA:        
    POP DX
    POPF
   JMP RET_BAIXO_CIMA  
    
    
  ;DIAGONAL SUPERIOR ESQUERDA  
    
    PROCURA_SUP_ESQUERDA:
    PUSHF  
    PUSH DX
    PUSH DI  
    
PROCURANDO_SUP_ESQUERDA:
    MOV DL, [SI]
    MOV DH, [DI]
    
    CMP DL, 0
    JE  ACHOU_SUBSTRING_SUP_ESQUERDA   
    
    CMP DH, '*'
    JE  PROXIMA_COLUNA_SUP_ESQUERDA 
    
    CMP DH, 0
    JE  NAO_ACHOU_SUBSTRING_SUP_ESQUERDA
    
    CMP DH,DL
    JE  IGUAL_PARCIAL_SUP_ESQUERDA  
    
    MOV SI, OFFSET PALAVRA
    ADD DI, 43
    JMP PROCURANDO_SUP_ESQUERDA 
    
PROXIMA_COLUNA_SUP_ESQUERDA:
    POP DI
    INC DI
    PUSH DI
    JMP PROCURANDO_SUP_ESQUERDA     
    
IGUAL_PARCIAL_SUP_ESQUERDA:
    INC SI
    ADD DI, 43
    JMP PROCURANDO_SUP_ESQUERDA
    
ACHOU_SUBSTRING_SUP_ESQUERDA:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURANDO_SUP_ESQUERDA 
    
    
NAO_ACHOU_SUBSTRING_SUP_ESQUERDA:
    MOV AH,2
    MOV DL,"N"
    INT 21H
    
FIM_PROCURANDO_SUP_ESQUERDA:       
    POP DX
    POPF 
    JMP RET_SUP_ESQUERDA
    
    
    
    
    ;DIAGONAL SUPERIOR DIREITA 
 
PROCURA_SUP_DIREITA:
    PUSHF  
    PUSH DX
    JMP CHEGAR_FINAL_SUP_DIREITA
          
CHEGAR_FINAL_SUP_DIREITA: 
    MOV DH, [DI]
    CMP DH, '@' 
    JE CHEGOU_FINAL_SUP_DIREITA
    INC DI
    JMP CHEGAR_FINAL_SUP_DIREITA 

CHEGOU_FINAL_SUP_DIREITA:
    PUSH DI
    JMP PROCURANDO_SUP_DIREITA
      
    
PROCURANDO_SUP_DIREITA:
    MOV DL, [SI]
    MOV DH, [DI]
    
    CMP DL, 0
    JE  ACHOU_SUBSTRING_SUP_DIREITA   
    
    CMP DH, '*'
    JE  PROXIMA_COLUNA_SUP_DIREITA 
    
    CMP DH, '!'
    JE  NAO_ACHOU_SUBSTRING_SUP_DIREITA
    
    CMP DH,DL
    JE  IGUAL_PARCIAL_SUP_DIREITA  
    
    MOV SI, OFFSET PALAVRA
    ADD DI, 41
    JMP PROCURANDO_SUP_DIREITA 
    
PROXIMA_COLUNA_SUP_DIREITA:
    POP DI
    DEC DI
    PUSH DI
    JMP PROCURANDO_SUP_DIREITA    
    
IGUAL_PARCIAL_SUP_DIREITA:
    INC SI
    ADD DI,41
    JMP PROCURANDO_SUP_DIREITA
    
ACHOU_SUBSTRING_SUP_DIREITA:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURANDO_SUP_DIREITA 
    
    
NAO_ACHOU_SUBSTRING_SUP_DIREITA:
    MOV AH,2
    MOV DL,"N"
    INT 21H   
    
FIM_PROCURANDO_SUP_DIREITA:   
    POP DX
    POPF
    JMP RET_SUP_DIREITA 



    ;DIAGONAL INFERIOR ESQUERDA
 
PROCURA_INF_ESQUERDA:
    PUSHF  
    PUSH DX
    PUSH DI
    JMP PROCURANDO_INF_ESQUERDA             
    
PROCURANDO_INF_ESQUERDA:
    MOV DL, [SI]
    MOV DH, [DI]
    
    CMP DL, 0
    JE  ACHOU_SUBSTRING_INF_ESQUERDA   
    
    CMP DH, '$'
    JE  PROXIMA_COLUNA_INF_ESQUERDA 
    
    CMP DH, '@'
    JE  NAO_ACHOU_SUBSTRING_INF_ESQUERDA
    
    CMP DH,DL
    JE  IGUAL_PARCIAL_INF_ESQUERDA  
    
    MOV SI, OFFSET PALAVRA
    SUB DI, 41
    JMP PROCURANDO_INF_ESQUERDA 
    
PROXIMA_COLUNA_INF_ESQUERDA:
    POP DI
    INC DI
    PUSH DI
    JMP PROCURANDO_INF_ESQUERDA    
    
IGUAL_PARCIAL_INF_ESQUERDA:
    INC SI
    SUB DI,41
    JMP PROCURANDO_INF_ESQUERDA
    
    
    
    
ACHOU_SUBSTRING_INF_ESQUERDA:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURANDO_INF_ESQUERDA 
    
    
NAO_ACHOU_SUBSTRING_INF_ESQUERDA:
    MOV AH,2
    MOV DL,"N"
    INT 21H
         
    
    
FIM_PROCURANDO_INF_ESQUERDA:
    
    POP DX
    POPF
   ; RET 
    JMP RET_INF_ESQUERDA


;PROCURA INF DIREITA    
    
PROCURA_INF_DIREITA:
    PUSHF  
    PUSH DX
    JMP CHEGAR_FINAL_INF_DIREITA
          
CHEGAR_FINAL_INF_DIREITA: 
    MOV DH, [DI]
    CMP DH, '@' 
    JE CHEGOU_FINAL_INF_DIREITA
    INC DI
    JMP CHEGAR_FINAL_INF_DIREITA 

CHEGOU_FINAL_INF_DIREITA:
    PUSH DI
    JMP PROCURANDO_INF_DIREITA
      
    
PROCURANDO_INF_DIREITA:
    MOV DL, [SI]
    MOV DH, [DI]
    
    CMP DL, 0
    JE  ACHOU_SUBSTRING_INF_DIREITA   
    
    CMP DH, '$'
    JE  PROXIMA_COLUNA_INF_DIREITA 
    
    CMP DH, '!'
    JE  NAO_ACHOU_SUBSTRING_INF_DIREITA
    
    CMP DH,DL
    JE  IGUAL_PARCIAL_INF_DIREITA  
    
    MOV SI, OFFSET PALAVRA
    SUB DI, 43
    JMP PROCURANDO_INF_DIREITA 
    
PROXIMA_COLUNA_INF_DIREITA:
    POP DI
    DEC DI
    PUSH DI
    JMP PROCURANDO_INF_DIREITA    
    
IGUAL_PARCIAL_INF_DIREITA:
    INC SI
    SUB DI, 43
    JMP PROCURANDO_INF_DIREITA
    
ACHOU_SUBSTRING_INF_DIREITA:
    MOV AH,2
    MOV DL,"S"
    INT 21H
    JMP FIM_PROCURANDO_INF_DIREITA 
    
    
NAO_ACHOU_SUBSTRING_INF_DIREITA:
    MOV AH,2
    MOV DL,"N"
    INT 21H   
    
FIM_PROCURANDO_INF_DIREITA:   
    POP DX
    POPF
     
   JMP RET_INF_DIREITA     
    
    
        
PULA_LINHA:                      
    pushf
    push ax
    push dx
    MOV AH,2
    MOV DL,13        
    INT 21H
    MOV AH,2
    MOV DL,10
    INT 21H
    pop dx        
    pop ax
    popf
    RET 
    
    

;PROCURA BAIXO CIMA
 

PALAVRA DB TAMANHO DUP(" "),0  

                                                       
;use qualquer marcador                                                          
;fixo 10x40
         DB 0,"#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@"
INICIO_A DB   "!MSJDFLKASJDKFLJSADKLFJKKLSJDFKLASJDFKJSM@"
         DB   "!AIJDFLKASJDKFLJSADKLFJJKLSJDFKLASJDFKJIA@"
         DB   "!ALGKDFJKLASDJFFMSAJDKLJJSADKLFJLKDSAJGLK@"
         DB   "!ASJUFLKASMIGUELISADKLEUAKLSJDFKLESJMUKJS@"
         DB   "!ALLKELDFASDDJFHGSAJDKUEJSADKLFJLKULEJFLK@"
         DB   "!ASEDELKASJDKFLKUADKLFGLKLSJDFKLASJLEKJSA@"
         DB   "!ALUUDFJKLASDJFEESAJDKILJSADKLFJLKKSUUFLK@"
         DB   "!ASGDFLKASJDKFLLLADKLFMAKLSJDFKLASJDEMGSA@"
         DB   "!AIIKDFJKLASDJFJKSAJDKFLJSALEUGIMKDSLJFIK@"
INICIO_B DB   "!MSFDFLKASJDKFLJSADKLFJAKLSJDFKLASJDFKJSM@"
         DB   "*****************************************#",0
